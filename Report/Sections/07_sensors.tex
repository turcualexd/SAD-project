\section{Sensors}
\label{sec:sensors}

Sensors are fundamental tools that allows the SC to know its orientation or angular velocity. Their presence onboard 
is fundamental for having a controlled motion of the satellite. In this section, the 3 sensors used will be presented, 
it will be also clarified the motivation that lead the team to choose two additional sensors over the horizon sensor 
assigned. 

\subsection{Horizon Sensor}
\label{subsec:horizon_sensor}
Horizon sensors are devices that can detect the centre of the planet, in our case Earth, and reconstruct the direction 
of that point with respect to the satellite. They usually work by analyzing the IR spectrum of the image through a thermopile
to reduce the visible light spectrum interference caused by transition of day and night on earth. 
Due to the nadir pointing requirment a static earth sensor has been chosen for this specific application. In particular, the 
\textit{Meisei Earth Horizon} was chosen, which has the following specifics:

\begin{table}[H]

    \centering
    \begin{tabular}{|c|c|c|}
    \hline
    $\bm{F.O.V. \, [\deg]}$ & $\bm{Accuracy \, [\deg]}$ & $\bm{Frequency \, [Hz]}$ \\
    \hline
    $33$ & $1$ & $30$  \\
    \hline
    \end{tabular}
    
    \caption{Real data for Horizon Sensor}
    \label{table:Hor_sensor}
    
\end{table}

Due to operational requirements, the static sensor has to point the Earth, in particular the optical
axis must have the same direction of the nadir (direction that links centre of earth and CoM of the S/C).
To fulfill this request, a good option could be to position the sensor on the face that also contains the 
payload, that is the face of the spacecraft main body (cube) that has normal along the $\boldsymbol{x_b}$ 
direction. 

The model implemented to simulate the behaviour of the sensor in the Simulink environment 
takes the real position of the S/C with respect to centre of Earth expressed in inertial space, changes its
direction multiplying by -1 and expresses it in the $\mathcal{B}$ frame through the real attitude matrix $\boldsymbol{A_{B,N}}$. 
This unit vector is the input of the sensor block, here it is sampled through a zero-order hold of frequency specified by
\autoref{table:Hor_sensor} to simulate the digital nature of the sensor. Then some errors of measurments has to be added.
It was decided to model two typical effects of real sensor: the mounting error that cause misalignment and also an 
accuracy error modeled with a band-limited white noise on all the components of the direction vector. 
Chronologically, first the misalignment is calculated, then the noise is introduced:
\begin{itemize}
    \item The misalignment error was computed on Simulink by introducing a small deviation with respect to the nominal condition. This can
    be done by adding a small-scaled vector in the direction perpendicular of the unit vector that has to be measured. The scaling of 
    this vector has to be small with respect to the unit direction considered as the measurment. Since the vector of the measured 
    direction is initially unitary, the length of the bias vector introduced can be considered as $\tan{\theta_{small}} \approx \theta_{small}$,
    where $\theta_{small}$ represents the angle between real measurment and misaligned measurment. The $\theta_{small}$ selected is ... 
    \item In the Simulink environment the white noise has to be defined through the power spectral density. This was selected as $N_p = \sigma^2 {T_s} $, 
    where $sigma^2$ represents the variance as the standard deviation squared, while $T_s$ is the sampling time of the sensor.
    It was decided to consider as standard deviation the value of $1\deg$ (that is the accuracy from \autoref{table:Hor_sensor})
\end{itemize}


\subsection{Magnetometer}
Due to the LEO orbit and seen that from \autoref{subsec:sim_disturbances} the magnetic field  was considered as one of the main disturbances, 
it was thought that a magnetometer could have been a sensor to implement on-board the satellite. This kind of sensor are in general less accurate 
than optical sensor as sun sensor or star sensor, but since the magnetic field of LEO orbit is effectively enough strong, the sensor can provide 
always a measurment. Also, having a magnetorquer assigned as mandatory, the coupling of this actuator with a magnetometer can be exploited during 
the de-tumbling manuever since a direct dipole command is produced by the so-called \textit{B-dot Control}, extensively discussed in section (...)

The fluxgate magnetometer typology is used, where for each body axis, two ferromagnetic cores are used parallel to the specific axis. The primary coil 
saturates the two bars alternatively in opposite direction, so that the secondary output theoretically can read a null induced voltage output produced 
by the time-varying flux. When external field is present, the symmetry of the alternate saturation is broken so that a shift on the magnetic flux of the 
secondary coil is produced. This net flux can be read by the time-history of a voltmeter on the secondary coil, since the spacing of the measured output
voltage depends on the external magnetic field value. 

Since magnetometer are usually characterized by low accuracy values, we searched for a high-accuracy and low-noise typology. The research of a suitable
sensor opted for \textit{MM200} furnished by \textit{AAC ClydeSpace}. The following performance paramters characterize the sensor:

\begin{table}[H]

    \centering
    \begin{tabular}{|c|c|}
    \hline
     $\bm{N.S.D \, [nT/\sqrt{Hz}]}$ & $\bm{Frequency \, [Hz]}$ \\
    \hline
    $1.18$ & $<500$  \\
    \hline
    \end{tabular}
    
    \caption{Real data for Magnetometer Sensor}
    \label{table:mag_sensor}
    
\end{table}

For the Simulink model, the same approach of the Horizon sensor in \autoref{subsec:horizon_sensor} has been used. In particular, the magnetic fiel vector
from the block of \autoref{subsec:dist_mag} has been trasnformed into the $\mathcal{B}$ reference frame through the attitude matrix from the true kinematics 
block \autoref{sec:kinematics}. This is the input vector that has to be sampled with a frequency specified by \autoref{table:mag_sensor}. For this case a range
of frequencies can be chosen: we used the same frequency of the horizon sensor from \autoref{table:Hor_sensor} since it respects the constraint 
given by the magnetometer requirments. 

Then the measurments errors have to be added, a first misalignment error modeled in the same way of the horizon sensor in \autoref{subsec:horizon_sensor}. For this case the perpendicular
vector has been scaled by a factor of (...).
The accuracy error, induced by the noise, has been modeled through a band-limited white noise added on each component. The value of the PSD is the square of 
the NSD presented in \autoref{table:mag_sensor}.